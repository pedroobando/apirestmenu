# Docker Compose Configuration for API Restaurante
#
# IMPORTANTE: Este archivo usa variables de entorno que deben estar definidas
# en un archivo .env en la raíz del proyecto.
#
# PASO 1: Renombrar el archivo example.env a .env
#   mv example.env .env
#
# PASO 2: Configurar las variables en el archivo .env
#   - Las variables de ejemplo están en example.env
#   - Todas las variables ${VARIABLE} deben estar definidas en .env
#
# PASO 3: Iniciar los servicios
#   docker-compose up -d
#
# Servicios incluidos:
#   - PostgreSQL 17 (puerto 5444)
#   - MinIO Object Storage (puertos 9200/9201)
#   - pgAdmin (puerto 8091)

# version: '3'

services:
  postgresdb:
    image: postgres:17-alpine
    # restart: always
    ports:
      - '5444:5432'
    environment:
      POSTGRES_USER: ${DB_USER}
      POSTGRES_PASSWORD: ${DB_PASSWORD}
      POSTGRES_DB: ${DB_NAME}
    container_name: ${CONTAINER_NAMEDB}
    volumes:
      - ./postgres:/var/lib/postgresql/data
    networks:
      - network

  bucket:
    image: minio/minio:RELEASE.2024-12-18T13-15-44Z.fips
    # RELEASE.2024-10-29T16-01-48Z.fips
    # restart: always
    ports:
      - '9200:9000'
      - '9201:9001'
    environment:
      MINIO_ROOT_USER: ${MINIO_ROOT_USER}
      MINIO_ROOT_PASSWORD: ${MINIO_ROOT_PASSWORD}
    container_name: ${MINIO_CONTAINER}
    volumes:
      - ./minio:/data
    command: server --console-address ":9001" /data
    networks:
      - network

  pgAdmin:
    image: elestio/pgadmin:REL-9_8
    # restart: always
    ports:
      - 8091:80
    environment:
      PGADMIN_DEFAULT_EMAIL: admin@gmail.com
      PGADMIN_DEFAULT_PASSWORD: 1234
    container_name: rest-pga
    networks:
      - network

networks:
  network:
    driver: bridge
